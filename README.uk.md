# WellInsightEngine

WellInsightEngine - це система для формування інженерних інсайтів по свердловинах на основі історичних даних, зафіксованих інцидентів/дій, а також очищених часових рядів технічних параметрів.

Цей проєкт був розроблений та представлений під час хакатону **DEV Challenge**, організованого **MODUS X** та **DTEK**.

Рішення використовує AI для аналізу поточного стану свердловини в контексті вже відомих інженерних кейсів.  
Система зіставляє динаміку параметрів із подібними ситуаціями з історичного датасету та формує зрозумілий інженерний інсайт: що відбувається, з якими кейсами це схоже та які дії можуть бути доцільними.

Результат подається у вигляді окремого AI-інсайту по конкретній свердловині, який можна зберегти та поширити через унікальне посилання для подальшого аналізу командою.

---

## Архітектура

- **ASP.NET Core API**
- **PostgreSQL (домен свердловин)**  
  Свердловини, параметри, звʼязки, метадані (EF Core)
- **TimescaleDB (домен метрик)**  
  Сирі дані та ієрархічні агрегації
- **AI-провайдер (Gemini)**  
  Для генерації інсайтів (може бути вимкнений локально)
- **Авторизація (Clerk)**  
  JWT + allow-list email (може бути вимкнена локально)

Зовнішні сервіси можуть бути замокані для локальної розробки.

---

## Основні можливості

- Збір часових рядів метрик
- Ієрархічні агрегації (1m → 5m → 10m → 30m → 1h → …)
- Швидкі запити через TimescaleDB
- Підтримка дельт та трендів
- AI-інсайти
- Поширювані посилання на інсайти

---

## Локальний запуск (Docker)

### Вимоги

- Docker Desktop
- Docker Compose v2+

### Сервіси

- `postgres-wells` - PostgreSQL для домену свердловин
- `timescaledb` - TimescaleDB для метрик
- `api` - WellInsightEngine API

AI та авторизація за замовчуванням **вимкнені**.

---

## Конфігурація

Основні флаги:

- `Database__MigrateOnStartup=true`
- `Ai__Disabled=true`
- `Klerk__Disabled=true`

---

## Ініціалізація бази

1. Docker Compose піднімає PostgreSQL і TimescaleDB
2. TimescaleDB ініціалізується
3. Виконується `infra/sql/setup.sh`:
   - Спочатку `well_metrics.sql`
   - Потім всі SQL-файли рекурсивно
4. API стартує з автоматичними міграціями EF Core

---

## Запуск

```bash
docker compose up --build
